#!/bin/bash

# ะกะบัะธะฟั ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะผะพะฝัะธัะพะฒะฐะฝะธั HDD ะฟัะธ ััะฐััะต ัะธััะตะผั
# ะธ ะฟะตัะตะทะฐะฟััะบะฐ Aether Player

echo "๐ง ะะพะฝัะธัะพะฒะฐะฝะธะต HDD ะธ ะทะฐะฟััะบ Aether Player..."

# ะัะพะฒะตััะตะผ, ะฟะพะดะบะปััะตะฝ ะปะธ ะดะธัะบ
if ! lsblk | grep -q "sda2"; then
    echo "โ HDD ะฝะต ะฟะพะดะบะปััะตะฝ (sda2 ะฝะต ะฝะฐะนะดะตะฝ)"
    exit 1
fi

# ะกะพะทะดะฐะตะผ ัะพัะบั ะผะพะฝัะธัะพะฒะฐะฝะธั
sudo mkdir -p /mnt/hdd

# ะัะพะฒะตััะตะผ, ะฝะต ัะผะพะฝัะธัะพะฒะฐะฝ ะปะธ ัะถะต ะดะธัะบ
if ! mountpoint -q /mnt/hdd; then
    echo "๐ ะะพะฝัะธััะตะผ HDD..."
    if sudo mount /dev/sda2 /mnt/hdd; then
        echo "โ HDD ััะฟะตัะฝะพ ัะผะพะฝัะธัะพะฒะฐะฝ"
    else
        echo "โ ะัะธะฑะบะฐ ะผะพะฝัะธัะพะฒะฐะฝะธั HDD"
        exit 1
    fi
else
    echo "โ HDD ัะถะต ัะผะพะฝัะธัะพะฒะฐะฝ"
fi

# ะัะพะฒะตััะตะผ ะดะพัััะฟ ะบ ะฟะฐะฟะบะต ั ะผัะทัะบะพะน
if [ -d "/mnt/hdd/MUSIC" ]; then
    echo "๐ต ะะฐะฟะบะฐ MUSIC ะฝะฐะนะดะตะฝะฐ"
    ls -la /mnt/hdd/MUSIC | head -3
else
    echo "โ๏ธ ะะฐะฟะบะฐ MUSIC ะฝะต ะฝะฐะนะดะตะฝะฐ, ัะพะทะดะฐะตะผ..."
    sudo mkdir -p /mnt/hdd/MUSIC
fi

# ะฃััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะฟัะฐะฒะฐ ะดะพัััะฟะฐ
sudo chmod 755 /mnt/hdd
sudo chmod -R 755 /mnt/hdd/MUSIC 2>/dev/null || true

echo "โ HDD ะณะพัะพะฒ ะบ ัะฐะฑะพัะต!"
echo "๐ ะะพัััะฟะฝัะต ะฟะฐะฟะบะธ:"
ls -la /mnt/hdd/ | grep '^d'

echo ""
echo "๐ ะขะตะฟะตัั ะผะพะถะฝะพ ะพัะบัััั http://$(hostname -I | awk '{print $1}'):5000"
