# Схема подключения реле 5В к Raspberry Pi

## Проблема
Raspberry Pi выдаёт 3.3V на GPIO, а реле требует 5V для надёжной работы.

## Решение: Оптопара + Транзистор

### Компоненты
- **Оптопара**: PC817 или 4N35
- **Транзистор**: 2N2222, BC547 или BC337 (NPN)
- **Резисторы**: 
  - R1: 220-330 Ом (ограничивает ток светодиода оптопары)
  - R2: 1-10 кОм (подтяжка базы транзистора)
- **Диод**: 1N4007 (защита от обратного тока катушки реле)

### Схема подключения

```
RPi GPIO 26 (Pin 37)
    |
    R1 (330Ω)
    |
    PC817 [1] ●——————●
             |        |
             |        | PC817 [4]
    RPi GND  ●————————●     |
                            R2 (1kΩ)
                            |
                        2N2222 [Base]
                            |
    +5V ————————————————————●——————————● Реле [+]
                            |
                        2N2222 [Collector]
                            |
                        2N2222 [Emitter]
                            |
                          GND ●——————————● Реле [-]
                                         |
                                      1N4007 (диод защиты)
```

### Пошаговое подключение

1. **Входная сторона (RPi → Оптопара)**:
   - GPIO 26 → Резистор 330 Ом → Анод светодиода PC817 (пин 1)
   - GND RPi → Катод светодиода PC817 (пин 2)

2. **Выходная сторона (Оптопара → Транзистор)**:
   - Коллектор фототранзистора PC817 (пин 4) → База 2N2222 через резистор 1 кОм
   - Эмиттер фототранзистора PC817 (пин 3) → GND

3. **Силовая часть (Транзистор → Реле)**:
   - +5V → Положительный контакт катушки реле
   - Отрицательный контакт катушки реле → Коллектор 2N2222
   - Эмиттер 2N2222 → GND
   - Диод 1N4007 параллельно катушке реле (катод к +5V)

### Принцип работы

1. **GPIO HIGH (3.3V)**: 
   - Ток течёт через светодиод оптопары
   - Фототранзистор открывается
   - Транзистор 2N2222 открывается
   - Реле получает питание 5V и включается

2. **GPIO LOW (0V)**:
   - Нет тока через светодиод
   - Фототранзистор закрыт
   - Транзистор 2N2222 закрыт
   - Реле обесточено и выключается

### Преимущества схемы

- ✅ **Гальваническая развязка**: RPi защищён от высокого напряжения
- ✅ **Правильное напряжение**: Реле получает необходимые 5V
- ✅ **Защита**: Диод защищает от обратного тока
- ✅ **Надёжность**: Стабильная работа переключения

### Альтернативные решения

#### Вариант 1: Готовый модуль реле
- Купить модуль реле с оптопарой (например, на базе SRD-05VDC-SL-C)
- Обычно работает от 3.3V сигнала
- Проще в подключении, но дороже

#### Вариант 2: Реле 3.3V
- Заменить реле на модель, работающую от 3.3V
- Прямое подключение к GPIO
- Меньше компонентов, но может быть менее надёжно при больших токах

### Тестирование

Используйте скрипт для проверки:

```bash
sudo python3 power-control.py test
```

Проверьте мультиметром:
- На GPIO должно быть 3.3V при включении
- На катушке реле должно быть 5V при включении
- Реле должно физически щёлкать при переключении

### Безопасность

⚠️ **ВНИМАНИЕ**: 
- Всегда отключайте питание при сборке схемы
- Проверяйте полярность диодов и транзисторов
- Используйте правильные номиналы резисторов
- Не превышайте максимальный ток GPIO (16 мА)
